{"version":3,"file":"commonHelpers.js","sources":["../src/js/http.js","../src/js/gallery.js"],"sourcesContent":["import axios from 'axios';\n\nconst PER_PAGE = 40;\nlet queryParam = '',\n  pageNumber = 1;\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\naxios.defaults.params = {\n  key: '22046149-41a2515b5a783e6a5f4bfbfcc',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: PER_PAGE,\n};\n\nasync function fetchImages({ query, isLoadMore = false }) {\n  pageNumber = isLoadMore ? pageNumber + 1 : 1\n\n  queryParam = query ?? queryParam;\n\n  return await axios.get('', {\n    params: {\n      q: queryParam,\n      page: pageNumber,\n    },\n  });\n}\n\nexport { fetchImages, pageNumber, PER_PAGE };\n","import { fetchImages, pageNumber, PER_PAGE } from './http';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-list'),\n  loadMoreButton: document.querySelector('.js-load-more'),\n};\nlet lightbox, cardHeight;\n\niziToast.settings({\n  timeout: 5000,\n  resetOnHover: true,\n  icon: 'material-icons',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n  position: 'center',\n});\n\nfunction renderGallery(data) {\n  return data\n    .map(\n      ({\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) =>\n        `<a class=\"photo-card\" aria-role=\"button\" href=\"${largeImageURL}\">\n          <div class=\"card-thumb\">\n            <img src=\"${webformatURL}\" class=\"card-image\" alt=\"${tags}\" height=\"250\" loading=\"lazy\" />\n          </div>\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b> ${likes}\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b> ${views}\n            </p>\n            <p class=\"info-item\">\n              <b>Comments</b> ${comments}\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b> ${downloads}\n            </p>\n          </div>\n        </a>`\n    )\n    .join('');\n}\n\nasync function handleChange(e) {\n  e.preventDefault();\n  refs.gallery.innerHTML = '';\n  refs.loadMoreButton.classList.add('hidden');\n\n  const query = e.target.elements.searchQuery.value.trim();\n  const { data } = await fetchImages({ query });\n\n  if (!data?.hits.length)\n    return iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n\n  iziToast.success({\n    message: `Hooray! We found ${data.totalHits} totalHits images`,\n    messageColor: '#fff',\n    backgroundColor: '#c139f6',\n  });\n\n  refs.gallery.insertAdjacentHTML('beforeend', renderGallery(data.hits));\n  const { height } = refs.gallery.firstElementChild.getBoundingClientRect();\n  cardHeight = height;\n\n  refs.loadMoreButton.classList.remove('hidden');\n  lightbox = new SimpleLightbox('.js-list a');\n}\n\nasync function handleLoadMoreButton() {\n  const { data } = await fetchImages({ query: null, isLoadMore: true });\n\n  if (data.totalHits <= pageNumber * PER_PAGE) {\n    refs.loadMoreButton.classList.add('hidden');\n    return iziToast.error({\n      title: 'Error',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  lightbox.destroy();\n  refs.gallery.insertAdjacentHTML('beforeend', renderGallery(data.hits));\n  lightbox = new SimpleLightbox('.js-list a');\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nrefs.form.addEventListener('submit', handleChange);\nrefs.loadMoreButton.addEventListener('click', handleLoadMoreButton);\n"],"names":["PER_PAGE","queryParam","pageNumber","axios","fetchImages","query","isLoadMore","refs","lightbox","cardHeight","iziToast","renderGallery","data","webformatURL","tags","likes","views","comments","downloads","largeImageURL","handleChange","e","height","SimpleLightbox","handleLoadMoreButton"],"mappings":"owBAEA,MAAMA,EAAW,GACjB,IAAIC,EAAa,GACfC,EAAa,EAEfC,EAAM,SAAS,QAAU,2BACzBA,EAAM,SAAS,OAAS,CACtB,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUH,CACZ,EAEA,eAAeI,EAAY,CAAE,MAAAC,EAAO,WAAAC,EAAa,EAAK,EAAI,CACxD,OAAAJ,EAAaI,EAAaJ,EAAa,EAAI,EAE3CD,EAAaI,GAASJ,EAEf,MAAME,EAAM,IAAI,GAAI,CACzB,OAAQ,CACN,EAAGF,EACH,KAAMC,CACP,CACL,CAAG,CACH,CCpBA,MAAMK,EAAO,CACX,KAAM,SAAS,cAAc,iBAAiB,EAC9C,QAAS,SAAS,cAAc,UAAU,EAC1C,eAAgB,SAAS,cAAc,eAAe,CACxD,EACA,IAAIC,EAAUC,EAEdC,EAAS,SAAS,CAChB,QAAS,IACT,aAAc,GACd,KAAM,iBACN,aAAc,UACd,cAAe,WACf,SAAU,QACZ,CAAC,EAED,SAASC,EAAcC,EAAM,CAC3B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,EACA,cAAAC,CACD,IACC,kDAAkDA;AAAA;AAAA,wBAElCN,8BAAyCC;AAAA;AAAA;AAAA;AAAA,6BAIpCC;AAAA;AAAA;AAAA,6BAGAC;AAAA;AAAA;AAAA,gCAGGC;AAAA;AAAA;AAAA,iCAGCC;AAAA;AAAA;AAAA,aAI5B,EACA,KAAK,EAAE,CACZ,CAEA,eAAeE,EAAaC,EAAG,CAC7BA,EAAE,eAAc,EAChBd,EAAK,QAAQ,UAAY,GACzBA,EAAK,eAAe,UAAU,IAAI,QAAQ,EAE1C,MAAMF,EAAQgB,EAAE,OAAO,SAAS,YAAY,MAAM,OAC5C,CAAE,KAAAT,CAAI,EAAK,MAAMR,EAAY,CAAE,MAAAC,CAAO,CAAA,EAE5C,GAAI,EAACO,GAAA,MAAAA,EAAM,KAAK,QACd,OAAOF,EAAS,MAAM,CACpB,MAAO,QACP,QACE,0EACR,CAAK,EAEHA,EAAS,QAAQ,CACf,QAAS,oBAAoBE,EAAK,6BAClC,aAAc,OACd,gBAAiB,SACrB,CAAG,EAEDL,EAAK,QAAQ,mBAAmB,YAAaI,EAAcC,EAAK,IAAI,CAAC,EACrE,KAAM,CAAE,OAAAU,CAAM,EAAKf,EAAK,QAAQ,kBAAkB,wBAClDE,EAAaa,EAEbf,EAAK,eAAe,UAAU,OAAO,QAAQ,EAC7CC,EAAW,IAAIe,EAAe,YAAY,CAC5C,CAEA,eAAeC,GAAuB,CACpC,KAAM,CAAE,KAAAZ,GAAS,MAAMR,EAAY,CAAE,MAAO,KAAM,WAAY,EAAI,CAAE,EAEpE,GAAIQ,EAAK,WAAaV,EAAaF,EACjC,OAAAO,EAAK,eAAe,UAAU,IAAI,QAAQ,EACnCG,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,4DACf,CAAK,EAGHF,EAAS,QAAO,EAChBD,EAAK,QAAQ,mBAAmB,YAAaI,EAAcC,EAAK,IAAI,CAAC,EACrEJ,EAAW,IAAIe,EAAe,YAAY,EAE1C,OAAO,SAAS,CACd,IAAKd,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEAF,EAAK,KAAK,iBAAiB,SAAUa,CAAY,EACjDb,EAAK,eAAe,iBAAiB,QAASiB,CAAoB"}